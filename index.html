<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="keywords" content="Diffusion Hyperfeatures">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Diffusion Hyperfeatures: Searching Through Time and Space for Semantic Correspondence</title>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="stylesheet" href="./static/css/custom.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<section class="hero space-background has-text-white">
  <div class="hero-body space-background-overlay">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-2 publication-title has-text-white">Diffusion Hyperfeatures: <br> <span class="is-size-4">Searching Through Time and Space for Semantic Correspondence</span></h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://people.eecs.berkeley.edu/~graceluo">Grace Luo</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://www.lisabdunlap.com">Lisa Dunlap</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://scholar.google.com/citations?user=_kJ-zUYAAAAJ&hl=en">Dong Huk Park</a><sup>1*</sup>,
            </span>
            <span class="author-block">
              <a href="https://holynski.org">Aleksander Holynski</a><sup>1, 2*</sup>,
            </span>
            <span class="author-block">
              <a href="http://people.eecs.berkeley.edu/~trevor">Trevor Darrell</a><sup>1*</sup>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>UC Berkeley,</span>
            <span class="author-block"><sup>2</sup>Google Research</span>
            <br>
            <span class="is-size-7">*Equal advising contribution.</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <span class="link-block">
                <a href="https://arxiv.org/abs/2305.14334"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code (Coming Soon)</span>
                  </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Diffusion models have been shown to be capable of generating high-quality images, 
            suggesting that they could contain meaningful internal representations. 
            Unfortunately, the feature maps that encode a diffusion model's internal information are spread not only over layers of the network, 
            but also over diffusion timesteps, making it challenging to extract useful descriptors.
          </p>
          <p>
            We propose Diffusion Hyperfeatures, a framework for consolidating multi-scale and 
            multi-timestep feature maps into per-pixel feature descriptors that can be used for downstream tasks. 
            These descriptors can be extracted for both synthetic and real images using the generation and inversion processes. 
            We evaluate the utility of our Diffusion Hyperfeatures on the task of semantic keypoint correspondence:
            our method achieves superior performance on the SPair-71k real image benchmark.
            We also demonstrate that our method is flexible and transferable: 
            our feature aggregation network trained on the inversion features of real image pairs can be used on the generation features 
            of synthetic image pairs with unseen objects and compositions.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- A -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Diffusion Hyperfeatures</h2>
        <div class="content has-text-justified">
          <p>
            We extract feature maps varying across timesteps and layers from the diffusion process and
            consolidate them with our lightweight aggregation network to create our Diffusion Hyperfeatures, in
            contrast to prior methods that select a subset of raw diffusion features. For real images, we extract
            these features from the inversion process, and for synthetic images we extract these features from the
            generation process. Given a pair of images, we find semantic correspondences by performing nearest
            neighbors over their Diffusion Hyperfeatures.
          </p>
        </div>
        <figure class="image">
	  	  <img src="./assets/approach.png">
	  	</figure>
      </div>
    </div>
    <!--/ A -->
    <br>
    <!-- B -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Semantic Keypoint Matching on Real Images</h2>
        <div class="content has-text-justified">
          <p>
          	We distill Diffusion Hyperfeatures for semantic correspondence by tuning our aggregation network on real images from SPair-71k. The dataset is comprised of image pairs with annotated common semantic keypoints for a variety of object categories spanning vehicles, animals, and household objects.
          </p>
        </div>
        <div class="columns">
          <figure class="image column">
            <img src="./assets/spair_subset_1.png">
          </figure>
          <figure class="image column">
            <img src="./assets/spair_subset_2.png">
          </figure>
        </div>
      </div>
    </div>
    <!--/ B -->
    <!-- C -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Transfer to Synthetic Images</h2>
        <div class="content has-text-justified">
          <p>
           	We can take this same aggregation network tuned on these real images representing a limited set of object categories and apply it to synthetic images containing completely unseen and out-of-domain objects.
          </p>
        </div>
      
        <div class="columns">
          <figure class="image column">
            <img src="./assets/synthetic_subset_1.png">
          </figure>
          <figure class="image column">
            <img src="./assets/synthetic_subset_2.png">
          </figure>
        </div>
      </div>
    </div>
    <!--/ C -->
  </div>
</section>

<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{luo2023dhf,
  author    = {Luo, Grace and Dunlap, Lisa and Park, Dong Huk and Holynski, Aleksander and Darrell, Trevor},
  title     = {Diffusion Hyperfeatures: Searching Through Time and Space for Semantic Correspondence},
  journal   = {arXiv},
  year      = {2023},
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a 
            <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
              Creative Commons Attribution-ShareAlike 4.0 International License
            </a>. 
            The website template is from the 
            <a href="https://github.com/nerfies/nerfies.github.io">
              Nerfies
            </a> 
            project page.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
